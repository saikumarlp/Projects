<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Checklist | Placement Readiness</title>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:wght@600;700&display=swap"
        rel="stylesheet">
    <!-- Global Styles -->
    <link rel="stylesheet" href="../styles.css">
    <style>
        .checklist-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            border-bottom: 1px solid #eee;
            transition: background 0.2s;
        }

        .checklist-item:hover {
            background: #fafafa;
        }

        .checklist-item input[type="checkbox"] {
            margin-top: 4px;
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--color-success);
        }

        .checklist-label {
            font-weight: 500;
            cursor: pointer;
        }

        .checklist-hint {
            font-size: 13px;
            color: #666;
            margin-top: 4px;
        }

        .status-header {
            background: #fff;
            padding: 24px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    </style>
</head>

<body>

    <!-- TOP BAR -->
    <nav class="top-bar">
        <div class="container top-bar__inner">
            <a href="index.html" class="brand">KodNest Premium</a>
            <div class="nav-links">
                <a href="index.html" class="nav-link">Scorecard</a>
                <a href="dashboard.html" class="nav-link">Dashboard</a>
                <a href="analyze.html" class="nav-link">JD Analyzer</a>
                <a href="test.html" class="nav-link active">Test</a>
                <a href="ship.html" class="nav-link">Ship</a>
                <a href="proof.html" class="nav-link">Proof</a>
            </div>
        </div>
    </nav>

    <!-- STATUS HEADER -->
    <div class="status-header container">
        <div>
            <h1 style="margin: 0; font-size: 24px;">Pre-Flight Checklist</h1>
            <p style="margin: 4px 0 0; color: #666;">Verify all features before shipping.</p>
        </div>
        <div style="text-align: right;">
            <div id="progressText" style="font-size: 18px; font-weight: 700; color: var(--color-accent);">0/10 Passed
            </div>
            <button id="resetBtn" class="btn btn--secondary"
                style="margin-top: 8px; font-size: 12px; padding: 4px 12px;">Reset Checklist</button>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <main class="container" style="padding-top: 24px; padding-bottom: 64px;">

        <div class="card" style="max-width: 800px; margin: 0 auto;">
            <div class="card-header">
                <div class="card-title">Placement Readiness Platform Tests</div>
            </div>
            <div class="card-content" style="padding: 0;">
                <div id="checklistContainer">
                    <!-- Items injected here -->
                </div>
            </div>
        </div>

        <div id="shipWarning"
            style="text-align: center; margin-top: 32px; color: var(--color-accent); font-weight: 600; display: none;">
            ⚠️ Fix issues before shipping.
        </div>

        <div id="shipReady" style="text-align: center; margin-top: 32px; display: none;">
            <a href="ship.html" class="btn btn--primary">All Tests Passed. Proceed to Ship &rarr;</a>
        </div>

    </main>

    <script>
        const checklistItems = [
            { id: "t1", label: "JD required validation works", hint: "Try analyzing with empty text. Should block." },
            { id: "t2", label: "Short JD warning shows for <200 chars", hint: "Paste short text. Check validation message." },
            { id: "t3", label: "Skills extraction groups correctly", hint: "Check if React goes to Web, Python to Languages." },
            { id: "t4", label: "Round mapping changes based on company + skills", hint: "Google = 4 Rounds (DSA), Startup = 3 Rounds (Dev)." },
            { id: "t5", label: "Score calculation is deterministic", hint: "Same JD should always give same base score." },
            { id: "t6", label: "Skill toggles update score live", hint: "Toggle 'Know' buttons, score ring should animate." },
            { id: "t7", label: "Changes persist after refresh", hint: "Reload page after toggling. State should remain." },
            { id: "t8", label: "History saves and loads correctly", hint: "Check 'Recent Analysis' list on /analyze." },
            { id: "t9", label: "Export buttons copy the correct content", hint: "Click 'Copy Plan' and paste in notepad." },
            { id: "t10", label: "No console errors on core pages", hint: "Open DevTools > Console. Should be clean." }
        ];

        const container = document.getElementById('checklistContainer');
        const progressText = document.getElementById('progressText');
        const shipWarning = document.getElementById('shipWarning');
        const shipReady = document.getElementById('shipReady');
        const resetBtn = document.getElementById('resetBtn');

        function render() {
            const data = JSON.parse(localStorage.getItem('prpTestChecklist') || '{}');

            container.innerHTML = checklistItems.map(item => `
                <div class="checklist-item">
                    <input type="checkbox" id="${item.id}" ${data[item.id] ? 'checked' : ''} onchange="toggle('${item.id}')">
                    <div>
                        <label for="${item.id}" class="checklist-label">${item.label}</label>
                        <div class="checklist-hint">${item.hint}</div>
                    </div>
                </div>
            `).join('');

            updateProgress(data);
        }

        function toggle(id) {
            const data = JSON.parse(localStorage.getItem('prpTestChecklist') || '{}');
            data[id] = !data[id];
            localStorage.setItem('prpTestChecklist', JSON.stringify(data));
            updateProgress(data);
        }

        function updateProgress(data) {
            const checkedCount = checklistItems.filter(i => data[i.id]).length;
            progressText.innerText = `Tests Passed: ${checkedCount} / 10`;

            if (checkedCount === 10) {
                progressText.style.color = 'var(--color-success)';
                shipWarning.style.display = 'none';
                shipReady.style.display = 'block';
            } else {
                progressText.style.color = 'var(--color-accent)';
                shipWarning.style.display = 'block';
                shipReady.style.display = 'none';
            }
        }

        resetBtn.addEventListener('click', () => {
            if (confirm("Reset all test progress?")) {
                localStorage.removeItem('prpTestChecklist');
                render();
            }
        });

        render();
    </script>
</body>

</html>